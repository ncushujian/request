var request=function(){"use strict";var e=function e(t){return new Promise((r,n)=>{var a=function e(t,r){var n=JSON.parse(JSON.stringify(t));for(var a in r)"object"==typeof r[a]&&n[a]?n[a]=e(n[a],r[a]):n[a]=r[a];return n}(e.defaults,t);e.before&&e.before(a);var o=a.type?a.type.toLocaleUpperCase():"GET",i="POST"===o,s=!1,u=a.timeout||15e3,f=new XMLHttpRequest,c=function(e){if(!e)return"";var t=[];for(var r in e)t.push(encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t.join("&")}(a.data),p=a.url;!i&&(p+=(p.indexOf("?")>-1?"&":"?")+c),f.open(o,p,!0);var d=a.headers,l=!1;if(d)for(var v in l=d["Content-Type"]&&-1!==d["Content-Type"].indexOf("application/json"),d)f.setRequestHeader(v,d[v]);i&&!l&&f.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.withCredentials&&(f.withCredentials=!0);var y=0;f.onreadystatechange=function(){if(4==f.readyState){var t=f.status;if(t>=200&&t<300||304==t){var a=f.responseText,o=JSON.parse(a);try{e.after&&e.after(o)}catch(e){n(e)}r(o)}else n(new Error("request error:"+t+" "+f.statusText));s=!0,y&&clearTimeout(y)}},f.send(i?l?JSON.stringify(a.data):c:null),u&&(y=setTimeout((function(){s||(f.onreadystatechange=function(){},f.abort(),n(new Error("request timeout")))}),u))}).catch(t=>{throw e.error&&e.error(t),t})};return e.defaults={},e}();
